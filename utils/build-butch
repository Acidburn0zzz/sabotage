#!/bin/sh

tarxf https://github.com/downloads/rofl0r/butch/ butch-0.0.6 .tar.bz2 butch
filesize='58830'
sha512='53108559b97b6e8d0433b947fccd397c49e3cd84fe08ee64c553b73fd71a595c09c411d4950079230d487433a99081ab4cfb1d20f3f996b3c7070020a6f8217f'

filename="$S"/butch-0.0.6.tar.bz2

read sz _ <<EOF
$(du -b "$filename")
EOF

if [ "$sz" != "$filesize" ]; then
    printf -- "error: build-butch: wrong filesize. got: %d expected: %d\n" "$sz" "$filesize"
    exit 1
fi

read sha _ <<EOF
$(sha512sum "$filename")
EOF

if [ "$sha" != "$sha512" ]; then
    printf -- "error: build-butch: hash doesn't match.\n"
    exit 1
fi


./build.sh
cp butch/butch "$S"/butch.bin
cp "$filename" "$C"/

