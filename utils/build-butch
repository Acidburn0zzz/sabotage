#!/bin/sh

tarxf https://github.com/downloads/rofl0r/butch/ butch-0.0.7 .tar.bz2 butch
filesize='58779'
sha512='64d111a1a7d5bbea8afd1550780bceaf5be8b80caa71e169d3af91ecbc8a5f3d55e6aafea72f3a0475324281bf0c4c426c7f45b3105a8762207923e50f41fcf8'

filename="$S"/butch-0.0.7.tar.bz2

read sz _ <<EOF
$(du -b "$filename")
EOF

if [ "$sz" != "$filesize" ]; then
    printf -- "error: build-butch: wrong filesize. got: %d expected: %d\n" "$sz" "$filesize"
    exit 1
fi

read sha _ <<EOF
$(sha512sum "$filename")
EOF

if [ "$sha" != "$sha512" ]; then
    printf -- "error: build-butch: hash doesn't match.\n"
    exit 1
fi


./build.sh
cp butch/butch "$S"/butch.bin
cp "$filename" "$C"/

